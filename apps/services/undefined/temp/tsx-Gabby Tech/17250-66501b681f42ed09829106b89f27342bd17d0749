{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import os from\"os\";import cluster from\"cluster\";import{Kafka}from\"kafkajs\";import{ServicesConfig}from\"../config\";import{emailHandler}from\"./handlers/notifications/send-email\";const kafka=new Kafka({clientId:\"timeline-services\",brokers:ServicesConfig.kafka.brokers,ssl:true,sasl:{mechanism:\"scram-sha-256\",username:ServicesConfig.kafka.username,password:ServicesConfig.kafka.password}});const streamHandlers=[{streamKey:\"notifications.send-email\",handler:emailHandler}];async function start(){streamHandlers.forEach(async({streamKey,handler},idx)=>{const consumer=kafka.consumer({groupId:\"timeline-services:\"+os.hostname+\":\"+idx+\":\"+(cluster.worker?.id??process.pid)});try{await consumer.subscribe({topic:streamKey});await consumer.run({autoCommit:true,eachMessage:handler})}catch(err){console.log(err)}})}__name(start,\"start\");export{start};\n","warnings":[],"map":{"version":3,"mappings":"kHAAA,OAAO,OAAQ,KACf,OAAO,YAAa,UACpB,OAAS,UAAa,UACtB,OAAS,mBAAsB,YAE/B,OAAS,iBAAoB,sCAE7B,MAAM,MAAQ,IAAI,MAAM,CACtB,SAAU,oBACV,QAAS,eAAe,MAAM,QAC9B,IAAK,KACL,KAAM,CACJ,UAAW,gBACX,SAAU,eAAe,MAAM,SAC/B,SAAU,eAAe,MAAM,QACjC,CACF,CAAC,EAGD,MAAM,eAAiB,CACnB,CACI,UAAW,2BACX,QAAS,YACb,CACJ,EAGA,eAAsB,OAAO,CACzB,eAAe,QAAS,MAAO,CAAE,UAAW,OAAO,EAAG,MAAQ,CAC1D,MAAM,SAAW,MAAM,SAAS,CAC5B,QAAS,qBAAuB,GAAG,SAAW,IAAM,IAAM,KAAO,QAAQ,QAAQ,IAAM,QAAQ,IACnG,CAAC,EACD,GAAG,CACC,MAAM,SAAS,UAAU,CAAE,MAAO,SAAU,CAAC,EAC7C,MAAM,SAAS,IAAI,CACf,WAAY,KACZ,YAAa,OACjB,CAAC,CACL,OAAQ,IAAK,CACT,QAAQ,IAAI,GAAG,CACnB,CACJ,CAAC,CACL,CAfsB","names":[],"ignoreList":[],"sources":["D:\\Website Development\\Timeline-Mono\\apps\\services\\src\\start.ts"],"sourcesContent":[null]}}