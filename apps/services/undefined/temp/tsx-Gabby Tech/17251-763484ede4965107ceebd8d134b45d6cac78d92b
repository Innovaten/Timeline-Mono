{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{emailSubjectTemplates,emailBodyTemplates}from\"../templates/email-templates\";import{ServicesConfig}from\"../../../config\";import{Resend}from\"resend\";const resend=new Resend(ServicesConfig.mail.api_key);async function emailHandler(KafkaArgs){try{const{purpose,data}=JSON.parse(KafkaArgs.message.value.toString());const emailSubject=emailSubjectTemplates[purpose]({...data});const emailBody=emailBodyTemplates[purpose]({...data});const emailMetadata=await sendEmailRequest({email:data.email,subject:emailSubject,body:emailBody});console.log(`Sent ${purpose} email to ${data.email}. Email ID: ${emailMetadata?.data?.id}`)}catch(err){console.log(\"--- Kafka Email Handler Error ---\\n\",err.message?err.message:err)}}__name(emailHandler,\"emailHandler\");async function sendEmailRequest(args){try{const sendEmail=await resend.emails.send({from:`Timeline Trust Support <timelinetrust@${ServicesConfig.mail.domain}>`,to:[args.email],subject:args.subject,html:`\n            <html>\n              ${args.body}\n            </html>\n        `});if(sendEmail.error){throw new Error(sendEmail.error.name+\": \"+sendEmail.error.message)}return sendEmail}catch(err){console.log(`--- Resend Error ---\n`,err.message?err.message:err)}}__name(sendEmailRequest,\"sendEmailRequest\");export{emailHandler};\n","warnings":[],"map":{"version":3,"mappings":"kHACA,OAAS,sBAAuB,uBAA0B,+BAC1D,OAAS,mBAAsB,kBAE/B,OAAS,WAAc,SAEvB,MAAM,OAAS,IAAI,OAAO,eAAe,KAAK,OAAO,EAErD,eAAsB,aAAa,UAA8B,CAC7D,GAAI,CACA,KAAM,CAAE,QAAS,IAAK,EAAqB,KAAK,MAAM,UAAU,QAAQ,MAAO,SAAS,CAAC,EAEzF,MAAM,aAAe,sBAAsB,OAAO,EAAE,CAAE,GAAG,IAAI,CAAC,EAC9D,MAAM,UAAY,mBAAmB,OAAO,EAAE,CAAE,GAAG,IAAI,CAAC,EACxD,MAAM,cAAgB,MAAM,iBAAiB,CAAE,MAAO,KAAK,MAAO,QAAS,aAAc,KAAM,SAAU,CAAC,EAE1G,QAAQ,IAAI,QAAQ,OAAO,aAAa,KAAK,KAAK,eAAe,eAAe,MAAM,EAAE,EAAE,CAE9F,OAAS,IAAU,CACf,QAAQ,IAAI,sCAAuC,IAAI,QAAU,IAAI,QAAU,GAAG,CACtF,CACJ,CAbsB,oCAqBtB,eAAe,iBAAiB,KAAuB,CACnD,GAAG,CACC,MAAM,UAAY,MAAM,OAAO,OAAO,KAAK,CACvC,KAAM,yCAAyC,eAAe,KAAK,MAAM,IACzE,GAAI,CAAC,KAAK,KAAK,EACf,QAAS,KAAK,QACd,KAAM;AAAA;AAAA,gBAEF,KAAK,IAAI;AAAA;AAAA,SAEhB,CAAC,EAEF,GAAG,UAAU,MAAM,CACf,MAAM,IAAI,MAAM,UAAU,MAAM,KAAO,KAAO,UAAU,MAAM,OAAO,CACzE,CAEA,OAAO,SAEX,OAAS,IAAU,CACf,QAAQ,IAAI;AAAA,EAA0B,IAAI,QAAU,IAAI,QAAU,GAAG,CACzE,CACJ,CArBe","names":[],"ignoreList":[],"sources":["D:\\Website Development\\Timeline-Mono\\apps\\services\\src\\handlers\\notifications\\send-email.ts"],"sourcesContent":[null]}}